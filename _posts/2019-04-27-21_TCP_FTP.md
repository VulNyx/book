---
title: ðŸŸ¢ 21 FTP (TCP)
author: d4t4s3c
date: 2019-04-27
category: Jekyll
layout: post
---

## Basic Infomation

**File Transfer Protocol (FTP)** is a standard network protocol used to transfer files from one host to another over a TCP-based network, such as the internet.\
**Default Port:** `21`
```ruby
PORT   STATE SERVICE
21/tcp open  ftp
```

When [Nmap](https://nmap.org) cannot obtain the service header directly, it uses the [IANA](https://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xhtml) database to identify the service that might be running on a specific port.

---

## Enumeration

### Active

```ruby
nc -vn 192.168.1.2 21
timeout 0.1 bash -c "nc -nv 192.168.1.2 21"
nmap -sVC -p21 192.168.1.2
nmap -p21 --script="ftp-anon" 192.168.1.2
nmap -p21 --script="ftp-*" 192.168.1.2
```

### Pasive

#### Shodan

```ruby
port:21
port:21 vsftpd
port:21 proftpd 1.3.5
port:21 os:"Linux"
port:21 os:"Windows"
port:21 country:"US"
port:21 country:"US" os:"Linux"
port:21 hostname:"ftp.domain.tld"
```

---

## Connect

---

## Usage / Commands

---

### Brute Force

#### Password

If you got a `username` and need the `password` this is the way.

```ruby
# default port (21)
ncrack --user peter -P rockyou.txt ftp://192.168.1.2 -f
hydra -t 64 -l peter -P rockyou.txt ftp://192.168.1.2 -f -I
# other port
ncrack --user peter -P rockyou.txt ftp://192.168.1.2:1234 -f
hydra -t 64 -l peter -P rockyou.txt ftp://192.168.1.2:1234 -f -I
```

####

If you have a `password` and need the `username` this is the way.

---

### Hardening & Configuration

#### Interesting Files

- `/etc/vsftpd.conf` - This file is for **configuration**.
- `/var/log/vsftpd.log` - This file is for **logs**.


#### Service

```ruby
service vsftpd start
service vsftpd stop
service vsftpd restart
service vsftpd status

/etc/init.d/vsftpd start
/etc/init.d/vsftpd stop
/etc/init.d/vsftpd restart
/etc/init.d/vsftpd status

systemctl start vsftpd
systemctl stop vsftpd
systemctl restart vsftpd
systemctl status vsftpd
```














